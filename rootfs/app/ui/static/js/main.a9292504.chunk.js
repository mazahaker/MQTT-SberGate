(this["webpackJsonpcontroller-client"]=this["webpackJsonpcontroller-client"]||[]).push([[0],{192:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n(32),i=n.n(r),o=n(36),s=(n(192),n(193),n(19)),d=n(14),u=n(55),b=n(20),l=n(279),j=n(290),O=n(28),f=n.n(O),p=n(54),h="/api/v1/",x=function(){var e=Object(p.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"categories/").concat(t,"/features")).then((function(e){return e.json()}));case 2:return n=e.sent,a=n.features,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(p.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"transformations")).then((function(e){return e.json()}));case 2:return t=e.sent,n=t.transformations,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(p.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"categories")).then((function(e){return e.json()}));case 2:return t=e.sent,n=t.categories,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(p.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"models")).then((function(e){return e.json()}));case 2:return t=e.sent,n=t.models,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(p.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"objects")).then((function(e){return e.json()}));case 2:return t=e.sent,n=t.objects,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(p.a)(f.a.mark((function e(){var t,n,a,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([g(),fetch("".concat(h,"devices")).then((function(e){return e.json()}))]);case 2:return t=e.sent,n=Object(u.a)(t,2),a=n[0],c=n[1],r=a.reduce((function(e,t){return e[t.id]=t.model,e}),{}),e.abrupt("return",c.devices.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{model_name:e.model_id?r[e.model_id]:void 0})})));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(h,"devices"),(null===t||void 0===t?void 0:t.id)&&(n+="/".concat(t.id)),e.next=4,fetch(n,{method:(null===t||void 0===t?void 0:t.id)?"PUT":"POST",body:JSON.stringify(t)});case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(p.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"devices/").concat(t),{method:"DELETE"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(p.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"status")).then((function(e){return e.json()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(p.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"credentials"),{method:"POST",body:JSON.stringify(t)});case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(p.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h,"reload"),{method:"POST"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();!function(e){e.transformList="transform-list",e.objectList="object-list",e.deviceList="device-list",e.categoryList="category-list",e.modelList="model-list",e.categoryFeatureList="category-feature-list",e.status="status"}(a||(a={}));var F,T,M,I,z,E,P,Q,R,q,V,W,B,D,N,A,J,Y,H,K,U,G,X,Z,$,ee,te,ne,ae,ce,re,ie,oe,se,de,ue,be,le,je,Oe,fe,pe,he=n(277),xe=n(278),me=n(280),ve=n(168),ge=n(6),ye=function(e){var t=e.className;return Object(ge.jsx)(we,{className:t,children:Object(ge.jsx)(ke,{})})},we=b.a.div(F||(F=Object(s.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  background: rgba(255, 255, 255, 0.8);\n"]))),ke=Object(b.a)(ve.a)(T||(T=Object(s.a)(["\n  position: relative;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]))),Ce={labelCol:{span:6},wrapperCol:{span:18}},Le=function(e){var t=e.value,n=e.onChange,a=e.error,r=e.loading,i=void 0!==r&&r,o=Object(c.useCallback)((function(e){n(Object(d.a)(Object(d.a)({},t),e))}),[t,n]);return Object(ge.jsxs)(he.a,Object(d.a)(Object(d.a)({name:"CredentialsForm"},Ce),{},{onValuesChange:o,initialValues:t,autoComplete:"off",children:[i&&Object(ge.jsx)(_e,{}),a&&Object(ge.jsx)(Se,{type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f: ".concat(a)}),Object(ge.jsx)(he.a.Item,{label:"\u041b\u043e\u0433\u0438\u043d",name:"username",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d"}],children:Object(ge.jsx)(xe.a,{})}),Object(ge.jsx)(he.a.Item,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}],children:Object(ge.jsx)(xe.a,{})}),Object(ge.jsx)(he.a.Item,{label:"MQTT \u0411\u0440\u043e\u043a\u0435\u0440",name:"broker",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 MQTT \u0411\u0440\u043e\u043a\u0435\u0440"}],children:Object(ge.jsx)(xe.a,{})})]}))},Se=Object(b.a)(me.a)(M||(M=Object(s.a)(["\n  margin-bottom: 32px;\n"]))),_e=Object(b.a)(ye)(I||(I=Object(s.a)(["\n  transform: translate(-24px, -79px);\n"]))),Fe=n(281),Te=n(78),Me=n(35),Ie=n(275),ze=n(282),Ee=n(283),Pe=Object(c.memo)((function(e){var t=e.items,n=e.loading,a=e.onEdit,r=e.onAdd,i=e.onDelete,o=Object(c.useMemo)((function(){return function(e){return[{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",key:"name",render:function(e){return Object(ge.jsx)(Ve,{children:e})}},{title:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",dataIndex:"category",key:"category"},{title:"\u041c\u043e\u0434\u0435\u043b\u044c",dataIndex:"model_name",key:"model_name"},{title:"",dataIndex:"id",key:"delete",width:64,render:function(t){return Object(ge.jsx)(Fe.a,{title:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e?",okText:"\u0414\u0430",cancelText:"\u041d\u0435\u0442",onConfirm:function(n){n.stopPropagation(),e(t)},onCancel:function(e){e.stopPropagation()},children:Object(ge.jsx)(Te.a,{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e",children:Object(ge.jsx)(Me.a,{shape:"circle",icon:Object(ge.jsx)(ze.a,{}),onClick:function(e){e.stopPropagation()}})})})}}]}(i)}),[i]);return Object(ge.jsxs)("section",{children:[Object(ge.jsxs)(Qe,{children:[n&&Object(ge.jsx)(Re,{children:Object(ge.jsx)(qe,{size:"large"})}),Object(ge.jsx)(Ie.a,{dataSource:t.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{key:e.id})})),columns:o,pagination:!1,onRow:function(e){return{onClick:function(){return a(e)}}}})]}),Object(ge.jsx)(Me.a,{type:"primary",size:"large",icon:Object(ge.jsx)(Ee.a,{}),onClick:r,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e"})]})})),Qe=b.a.div(z||(z=Object(s.a)(["\n  border: 1px solid #dadada;\n  padding: 8px;\n  box-shadow: 0 -2px 15px inset rgba(0, 0, 0, 0.12);\n  height: calc(100vh - 286px);\n  margin-bottom: 24px;\n  overflow: scroll;\n  position: relative;\n"]))),Re=b.a.div(E||(E=Object(s.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  margin: -8px 0 0 -8px;\n  background: rgba(255, 255, 255, 0.8);\n"]))),qe=Object(b.a)(ve.a)(P||(P=Object(s.a)(["\n  position: relative;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]))),Ve=b.a.span(Q||(Q=Object(s.a)(["\n  color: #1890ff;\n  cursor: pointer;\n  transition: color .2s ease-in-out;\n  font-weight: 500;\n  \n  &:hover {\n    color: #40a9ff;\n  }\n"]))),We=function(e){var t=e.headerLeft,n=e.headerRight,a=e.contentLeft,c=e.contentRight,r=e.contentTop;return Object(ge.jsxs)(Ne,{children:[Object(ge.jsx)(Ae,{children:Object(ge.jsx)(Je,{children:Object(ge.jsxs)(Ye,{children:[Object(ge.jsx)(De,{children:Be}),Object(ge.jsx)(He,{children:"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0443\u043c\u043d\u044b\u043c \u0434\u043e\u043c\u043e\u043c Sber"}),Object(ge.jsx)("div",{children:r})]})})}),Object(ge.jsx)(Je,{children:Object(ge.jsxs)(Ue,{children:[Object(ge.jsxs)(Xe,{children:[Object(ge.jsx)(Ze,{children:t}),a]}),Object(ge.jsxs)(Ge,{children:[Object(ge.jsx)(Ze,{children:n}),c]})]})})]})},Be=Object(ge.jsxs)("picture",{children:[Object(ge.jsx)("source",{type:"image/webp",srcSet:"https://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/08f02/logo.webp 1x,\nhttps://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/e8cf1/logo.webp 1.5x,\nhttps://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/9a8c7/logo.webp 2x"}),Object(ge.jsx)("source",{srcSet:"https://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/9b0d1/logo.png 1x,\nhttps://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/767bb/logo.png 1.5x,\nhttps://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/a0e46/logo.png 2x"}),Object(ge.jsx)("img",{srcSet:"https://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/9b0d1/logo.png 1x,\nhttps://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/767bb/logo.png 1.5x,\nhttps://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/a0e46/logo.png 2x",src:"https://cdn-app.sberdevices.ru/sberdevices/0.52.0/static/f7aa246b0a403bdde25b798d9da74ad9/9b0d1/logo.png",alt:"",width:"156",height:"21",loading:"lazy"})]}),De=b.a.div(R||(R=Object(s.a)(["\n  padding-left: 5px;\n"]))),Ne=b.a.div(q||(q=Object(s.a)(['\n  min-height: 100vh;\n  background: #F7F7F7;\n  font-family: "SB Sans Text", Roboto, -apple-system, "Helvetica Neue", Helvetica, Arial, sans-serif;\n  color: #323F48;\n  font-size: 16px;\n']))),Ae=b.a.header(V||(V=Object(s.a)(["\n  height: 60px;\n  background: white;\n  box-shadow: rgb(155 155 155 / 15%) 5px 0 14px;\n  margin-bottom: 24px;\n"]))),Je=b.a.div(W||(W=Object(s.a)(["\n  max-width: 1600px;\n  margin: auto;\n"]))),Ye=b.a.div(B||(B=Object(s.a)(["\n  height: 60px;\n  display: flex;\n  align-items: center;\n"]))),He=b.a.div(D||(D=Object(s.a)(["\n  font-size: 19px;\n  margin-left: 32px;\n  color: #678;\n  flex-grow: 1;\n"]))),Ke=b.a.div(N||(N=Object(s.a)(["\n  box-shadow: rgba(155, 155, 155, 0.01) 5px 0 14px 0;\n  background: white;\n  padding: 28px 32px;\n  box-sizing: border-box;\n"]))),Ue=b.a.div(A||(A=Object(s.a)(["\n  display: flex;\n"]))),Ge=Object(b.a)(Ke)(J||(J=Object(s.a)(["\n  width: 400px;\n  margin-left: 24px;\n"]))),Xe=Object(b.a)(Ke)(Y||(Y=Object(s.a)(["\n  flex-grow: 1;\n  min-height: calc(100vh - 108px);\n"]))),Ze=b.a.div(H||(H=Object(s.a)(["\n  font-size: 23px;\n  margin-bottom: 1em;\n"]))),$e=n(64),et=n(284),tt=n(285),nt=n(286),at=function(e){var t=e.online,n=e.value,a=e.onEdit,c=e.onRefresh,r=e.loading,i=void 0!==r&&r,o=e.error,s=e.onReset,d=n.username,u=n.password,b=n.broker;return Object(ge.jsxs)("section",{children:[Object(ge.jsxs)(ut,{children:[t?Object(ge.jsx)(ct,{children:"\u0412 \u0441\u0435\u0442\u0438"}):Object(ge.jsx)(rt,{children:"\u041d\u0435 \u0432 \u0441\u0435\u0442\u0438"}),Object(ge.jsx)(bt,{icon:i?Object(ge.jsx)($e.a,{}):Object(ge.jsx)(et.a,{}),onClick:c,children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"})]}),o?Object(ge.jsx)(jt,{type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f: ".concat(o)}):Object(ge.jsx)(Ot,{}),Object(ge.jsxs)(ut,{children:[Object(ge.jsx)(Ze,{children:"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435"}),Object(ge.jsx)(lt,{icon:Object(ge.jsx)(tt.a,{}),onClick:s,children:"\u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c"})]}),Object(ge.jsxs)(it,{children:[Object(ge.jsx)(st,{children:"\u041b\u043e\u0433\u0438\u043d"}),Object(ge.jsx)(dt,{children:d})]}),Object(ge.jsxs)(it,{children:[Object(ge.jsx)(st,{children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(ge.jsx)(dt,{children:u})]}),Object(ge.jsxs)(ot,{children:[Object(ge.jsx)(st,{children:"MQTT \u0431\u0440\u043e\u043a\u0435\u0440"}),Object(ge.jsx)(dt,{children:b})]}),Object(ge.jsx)(Me.a,{type:"primary",size:"large",icon:Object(ge.jsx)(nt.a,{}),onClick:a,children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]})},ct=b.a.div(K||(K=Object(s.a)(["\n  color: #29C673;\n  font-weight: 500;\n  position: relative;\n  padding-left: 20px;\n  font-size: 19px;\n  margin-bottom: 24px;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    width: 12px;\n    height: 12px;\n    border-radius: 6px;\n    background: radial-gradient(#29C673, #2bb56c);\n    left: 0;\n    top: 9px;\n    box-shadow: 0 0 4px inset rgba(0, 0, 0, 0.2);\n  }\n"]))),rt=Object(b.a)(ct)(U||(U=Object(s.a)(["\n  color: #DF2737;\n  \n  &:before {\n    background: radial-gradient(#DF2737, #a82d38);\n    box-shadow: 0 0 4px inset rgba(0, 0, 0, 0.1);\n  }\n"]))),it=b.a.div(G||(G=Object(s.a)(["\n  display: flex;\n  \n  & > div:first-child {\n    padding: 8px 20px 8px 0;\n    width: 68px;\n    margin-right: 20px;\n    border-right: 1px solid #dadada;\n  }\n  \n  & > div:last-child {\n    padding-top: 8px;\n  }\n"]))),ot=Object(b.a)(it)(X||(X=Object(s.a)(["\n  & > div:first-child {\n    padding-top: 24px;\n  }\n  \n  & > div:last-child {\n    padding-top: 24px;\n  }\n  \n  margin-bottom: 32px;\n"]))),st=b.a.div(Z||(Z=Object(s.a)(["\n  font-size: 14px;\n  color: #567;\n  transform: translateY(1px);\n"]))),dt=b.a.div($||($=Object(s.a)(["\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  word-break: break-word;\n"]))),ut=b.a.div(ee||(ee=Object(s.a)(["\n  display: flex;\n  justify-content: space-between;\n"]))),bt=Object(b.a)(Me.a)(te||(te=Object(s.a)(["\n  transform: translateY(1px);\n"]))),lt=Object(b.a)(Me.a)(ne||(ne=Object(s.a)(["\n  transform: translateY(3px);\n"]))),jt=Object(b.a)(me.a)(ae||(ae=Object(s.a)(["\n  margin: 8px 0 24px 0;\n"]))),Ot=b.a.div(ce||(ce=Object(s.a)(["\n  border-bottom: 1px dotted #dadada;\n  margin: 8px 0 24px;\n"]))),ft=n(287),pt=n(288),ht=n(289),xt=function(){return Object(ge.jsxs)("section",{children:[Object(ge.jsx)(Me.a,{type:"link",icon:Object(ge.jsx)(ft.a,{}),href:"https://developers.sber.ru/docs/ru/smarthome/title-page",target:"_blank",children:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f"}),Object(ge.jsx)(Me.a,{type:"link",icon:Object(ge.jsx)(pt.a,{}),href:"LICENSE.html",target:"_blank",children:"\u041b\u0438\u0446\u0435\u043d\u0437\u0438\u044f"}),Object(ge.jsx)(Me.a,{type:"link",icon:Object(ge.jsx)(ht.a,{}),href:"mailto:smarthome@sberdevices.ru",children:"\u0422\u0435\u0445. \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430"})]})},mt=n(276),vt=mt.a.TabPane,gt=function(e){var t=e.value,n=e.onChange,a=e.loading,r=void 0!==a&&a,i=e.onValidStateChange,o=Object(c.useState)([]),s=Object(u.a)(o,2),b=s[0],l=s[1],j=t.category,O=void 0===j?"":j,f=t.model_id,p=void 0===f?"":f,h=t.object_mappings,x=void 0===h?{}:h,m=Object(c.useCallback)((function(e){e.aliases?n(Object(d.a)(Object(d.a)({},t),{},{nicknames:e.aliases.split(",").map((function(e){return e.trim()})).filter((function(e){return!!e}))})):e.groupString?n(Object(d.a)(Object(d.a)({},t),{},{groups:e.groupString.split(",").map((function(e){return e.trim()})).filter((function(e){return!!e}))})):n(Object(d.a)(Object(d.a)({},t),e))}),[t,n]),v=Object(c.useCallback)((function(e){n(Object(d.a)(Object(d.a)({},t),{},{object_mappings:e}))}),[t,n]),g=Object(c.useCallback)((function(e){var a=e.features,c=void 0===a?[]:a,r=e.category,i=e.model_id,o={};(null===c||void 0===c?void 0:c.length)?o.object_mappings=c.reduce((function(e,t){return e[t.name]=x[t.name]?x[t.name]:{},e}),{}):o.object_mappings={},l(c.filter((function(e){return e.required})).map((function(e){return e.name}))),t.category!==r&&(o.category=r),t.model_id!==i&&(o.model_id=i),Object.keys(o).length&&n(Object(d.a)(Object(d.a)({},t),o))}),[t,n,x]),y=Object(c.useMemo)((function(){return{category:O,model_id:p}}),[O,p]),w=Object(c.useMemo)((function(){var e,n;return Object(d.a)(Object(d.a)({},t),{},{aliases:(null!==(e=null===t||void 0===t?void 0:t.nicknames)&&void 0!==e?e:[]).join(", "),groupString:(null!==(n=null===t||void 0===t?void 0:t.groups)&&void 0!==n?n:[]).join(", ")})}),[t]),k=Object.keys(null!==x&&void 0!==x?x:{}).length,C=Object(c.useMemo)((function(){var e=t.category,n=t.name,a=t.object_mappings,c=void 0===a?{}:a;if(!e||!n)return!1;var r=!0;return Object.keys(c).filter((function(e){return b.includes(e)})).forEach((function(e){c[e].command_object||c[e].status_object||(r=!1)})),r}),[t,b]);return Object(c.useMemo)((function(){return i(C)}),[C,i]),Object(ge.jsxs)(he.a,{name:"DeviceForm",labelCol:{span:4},wrapperCol:{span:20},initialValues:w,onValuesChange:m,autoComplete:"off",labelAlign:"left",children:[r&&Object(ge.jsx)(yt,{}),Object(ge.jsxs)(mt.a,{defaultActiveKey:"1",onChange:function(){},children:[Object(ge.jsxs)(vt,{tab:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:[Object(ge.jsx)(wt,{}),Object(ge.jsx)(Wt,{value:y,onChange:g}),Object(ge.jsx)(he.a.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"name",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}],required:!0,children:Object(ge.jsx)(xe.a,{})}),Object(ge.jsx)(he.a.Item,{label:"\u0410\u043b\u0438\u0430\u0441\u044b",name:"aliases",children:Object(ge.jsx)(xe.a,{placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e"})}),Object(ge.jsx)(he.a.Item,{label:"\u0414\u043e\u043c",name:"home",children:Object(ge.jsx)(xe.a,{})}),Object(ge.jsx)(he.a.Item,{label:"\u041a\u043e\u043c\u043d\u0430\u0442\u0430",name:"room",children:Object(ge.jsx)(xe.a,{})}),Object(ge.jsx)(he.a.Item,{label:"\u0413\u0440\u0443\u043f\u043f\u044b",name:"groupString",children:Object(ge.jsx)(xe.a,{placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e"})})]},"1"),k>0&&Object(ge.jsxs)(vt,{tab:"\u0424\u0443\u043d\u043a\u0446\u0438\u0438 (".concat(k,")"),children:[Object(ge.jsx)(wt,{}),Object(ge.jsx)(Pt,{value:t.object_mappings,requiredFeatures:b,onChange:v})]},"2")]})]})},yt=Object(b.a)(ye)(re||(re=Object(s.a)(["\n  transform: translate(-24px, -79px);\n"]))),wt=b.a.div(ie||(ie=Object(s.a)(["\n  height: 16px;\n"]))),kt=n(118),Ct=n(273),Lt=n(274),St=n(272),_t=n(67),Ft=Object(c.memo)((function(e){var t=e.value,n=e.onChange,a=e.transformations,r=void 0===a?[]:a,i=e.transformationsLoading,o=void 0!==i&&i,s=e.objects,b=void 0===s?[]:s,l=Object(c.useState)(),j=Object(u.a)(l,2),O=j[0],f=j[1],p=Object(c.useState)(),h=Object(u.a)(p,2),x=h[0],m=h[1],v=Object(c.useCallback)((function(e){var t=e.id,n=e.description;return Object(ge.jsxs)(Mt,{children:[Object(ge.jsx)(It,{children:t}),Object(ge.jsx)(zt,{children:n})]})}),[]),g=Object(c.useCallback)((function(e){n(Object(d.a)(Object(d.a)({},t),e))}),[t,n]),y=Object(c.useMemo)((function(){var e;if(t.transform)return null===(e=r.find((function(e){return e.name===t.transform})))||void 0===e?void 0:e.help}),[t,r]),w=Object(c.useMemo)((function(){var e=b.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{value:e.id,label:v(e)})}));return O?e.filter((function(e){return-1!==e.id.toLocaleLowerCase().indexOf(O.toLocaleLowerCase())})):e}),[b,O,v]),k=Object(c.useMemo)((function(){var e;if(t.status_object)return null===(e=b.find((function(e){return e.id===t.status_object})))||void 0===e?void 0:e.description}),[t,b]),C=Object(c.useMemo)((function(){var e=b.filter((function(e){return!e.readonly})).map((function(e){return Object(d.a)(Object(d.a)({},e),{},{value:e.id,label:v(e)})}));return x?e.filter((function(e){return-1!==e.id.toLocaleLowerCase().indexOf(x.toLocaleLowerCase())})):e}),[b,x,v]),L=Object(c.useMemo)((function(){var e;if(t.status_object)return null===(e=b.find((function(e){return e.id===t.command_object})))||void 0===e?void 0:e.description}),[t,b]);return Object(ge.jsxs)(he.a,{name:"MappingForm",labelCol:{span:6},wrapperCol:{span:18},initialValues:t,onValuesChange:g,autoComplete:"off",children:[Object(ge.jsx)(he.a.Item,{label:"\u041e\u0431\u044a\u0435\u043a\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b",name:"command_object",children:Object(ge.jsx)(St.a,{options:C,onSearch:m})}),!!L&&Object(ge.jsx)(Ct.a,{children:Object(ge.jsx)(Lt.a,{span:18,offset:6,children:Object(ge.jsx)(Tt,{message:L})})}),Object(ge.jsx)(he.a.Item,{label:"\u041e\u0431\u044a\u0435\u043a\u0442 \u0441\u0442\u0430\u0442\u0443\u0441\u0430",name:"status_object",children:Object(ge.jsx)(St.a,{options:w,onSearch:f})}),!!k&&Object(ge.jsx)(Ct.a,{children:Object(ge.jsx)(Lt.a,{span:18,offset:6,children:Object(ge.jsx)(Tt,{message:k})})}),Object(ge.jsx)(he.a.Item,{label:"\u0422\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f",name:"transform",children:Object(ge.jsx)(_t.a,{loading:o,notFoundContent:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0442\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u2026",allowClear:!0,children:r.map((function(e){var t=e.name;return Object(ge.jsx)(_t.a.Option,{value:t,children:t},t)}))})}),!!y&&Object(ge.jsx)(Ct.a,{children:Object(ge.jsx)(Lt.a,{span:18,offset:6,children:Object(ge.jsx)(Tt,{message:y})})}),Object(ge.jsx)(he.a.Item,{label:"\u0410\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b",name:"transform_args",children:Object(ge.jsx)(xe.a,{placeholder:"\u0410\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b \u0442\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438"})})]})})),Tt=Object(b.a)(me.a)(oe||(oe=Object(s.a)(["\n  margin-bottom: 24px;\n"]))),Mt=b.a.div(se||(se=Object(s.a)(["\n  padding-bottom: 8px;\n"]))),It=b.a.div(de||(de=Object(s.a)(["\n  font-weight: 500\n"]))),zt=b.a.div(ue||(ue=Object(s.a)(["\n  font-size: 13px;\n"]))),Et=36e5,Pt=Object(c.memo)((function(e){var t=e.value,n=void 0===t?{}:t,r=e.onChange,i=e.requiredFeatures,s=Object(o.useQuery)(a.transformList,m,{refetchOnWindowFocus:!1,cacheTime:Et}),u=s.data,b=void 0===u?[]:u,l=s.isLoading,j=Object(o.useQuery)(a.objectList,y,{refetchOnWindowFocus:!1,cacheTime:Et}).data,O=void 0===j?[]:j,f=Object(c.useCallback)((function(e,t){r&&r(Object(d.a)(Object(d.a)({},n),{},Object(kt.a)({},e,t)))}),[n,r]),p=Object(c.useCallback)((function(e){var t=Object(d.a)({},n);delete t[e],r&&r(t)}),[n,r]);return Object(ge.jsx)("div",{children:Object.keys(n).map((function(e,t){var a=i.includes(e);return Object(ge.jsxs)("div",{children:[!!t&&Object(ge.jsx)(Rt,{}),Object(ge.jsxs)(Ct.a,{children:[Object(ge.jsxs)(Lt.a,{span:3,children:[a&&Object(ge.jsx)(Qt,{children:"*"}),e]}),Object(ge.jsx)(Lt.a,{span:19,children:Object(ge.jsx)(Ft,{value:n[e],onChange:function(t){return f(e,t)},transformations:b,transformationsLoading:l,objects:O})}),Object(ge.jsx)(qt,{span:2,children:Object(ge.jsx)(Me.a,{shape:"circle",icon:Object(ge.jsx)(ze.a,{}),disabled:a,onClick:function(){return p(e)}})})]})]},e)}))})})),Qt=b.a.div(be||(be=Object(s.a)(["\n  display: inline-block;\n  margin-right: 4px;\n  color: #ff4d4f;\n  font-size: 14px;\n  font-family: SimSun, sans-serif;\n  line-height: 1;\n"]))),Rt=b.a.div(le||(le=Object(s.a)(["\n  border-top: 2px dotted #e1e1e1;\n  height: 0;\n  margin: 8px 0 32px 0;\n"]))),qt=Object(b.a)(Lt.a)(je||(je=Object(s.a)(["\n  text-align: right;\n"]))),Vt=36e5,Wt=function(e){var t=e.value,n=e.onChange,r=Object(c.useRef)(!1),i=Object(c.useRef)(!1),s=Object(o.useQuery)(a.categoryList,v,{refetchOnWindowFocus:!1,cacheTime:Vt}),u=s.data,b=s.isLoading,l=Object(o.useQuery)(a.modelList,g,{refetchOnWindowFocus:!1,cacheTime:0}),j=l.data,O=l.isLoading,f=Object(o.useQuery)([a.categoryFeatureList,t.category],(function(){return x(t.category)}),{refetchOnWindowFocus:!1,cacheTime:Vt,enabled:!!t.category}).data;Object(c.useEffect)((function(){!r.current&&i.current||!(null===f||void 0===f?void 0:f.length)||(r.current=!1,i.current=!0,n(Object(d.a)(Object(d.a)({},t),{},{features:f})))}),[f,t,n]);var p=t.category,h=t.model_id,m=Object(c.useCallback)((function(e){if(r.current=!1,e){var a,c=(null!==j&&void 0!==j?j:[]).find((function(t){return t.id===e}));return console.log(null!==(a=t.category)&&void 0!==a?a:c),void n(Object(d.a)(Object(d.a)({},t),{},{model_id:e,category:t.category?t.category:c.category,features:c.features.map((function(e){return{name:e,required:!0}}))}))}n(Object(d.a)(Object(d.a)({},t),{},{model_id:e,features:null!==f&&void 0!==f?f:void 0}))}),[t,n,j,f]),y=Object(c.useCallback)((function(e){n(Object(d.a)(Object(d.a)({},t),{},{category:e})),!h&&e&&(r.current=!0)}),[t,n,h]),w=Object(c.useMemo)((function(){return p?(null!==j&&void 0!==j?j:[]).filter((function(e){return e.category===p})):null!==j&&void 0!==j?j:[]}),[j,p]);return Object(c.useEffect)((function(){if(h&&!i.current&&(null===j||void 0===j?void 0:j.length)){var e=(null!==j&&void 0!==j?j:[]).find((function(e){return e.id===h}));n(Object(d.a)(Object(d.a)({},t),{},{features:e.features.map((function(e){return{name:e,required:!0}}))})),i.current=!0}}),[h,t,n,j]),Object(ge.jsxs)("div",{children:[Object(ge.jsx)(he.a.Item,{label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",required:!0,children:Object(ge.jsx)(_t.a,{value:p,onChange:y,loading:b,notFoundContent:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u2026",children:(null!==u&&void 0!==u?u:[]).map((function(e){return Object(ge.jsx)(_t.a.Option,{value:e,children:e},e)}))})}),Object(ge.jsx)(he.a.Item,{label:"\u041c\u043e\u0434\u0435\u043b\u044c",children:Object(ge.jsx)(_t.a,{value:h,onChange:m,loading:O,notFoundContent:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u0438 \u2026",allowClear:!0,children:w.map((function(e){var t=e.id,n=e.model;return Object(ge.jsx)(_t.a.Option,{value:t,children:n},t)}))})})]})},Bt={okButtonProps:{size:"large",icon:Object(ge.jsx)(j.a,{})},cancelButtonProps:{size:"large"},visible:!0,cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",okText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"};var Dt=function(){var e,t=Object(c.useState)(),n=Object(u.a)(t,2),r=n[0],i=n[1],s=Object(c.useState)(),b=Object(u.a)(s,2),j=b[0],O=b[1],f=Object(c.useState)(!1),p=Object(u.a)(f,2),h=p[0],x=p[1],m=Object(o.useQuery)(a.deviceList,w,{refetchOnWindowFocus:!1}),v=m.data,g=m.isFetching,y=m.refetch,F=Object(o.useQuery)(a.status,L,{refetchOnWindowFocus:!1,cacheTime:0}),T=F.data,M=F.isFetching,I=F.refetch,z=Object(o.useMutation)(C,{onSuccess:function(){y()}}).mutate,E=Object(o.useMutation)(k,{onSuccess:function(){i(void 0),y()}}),P=E.mutate,Q=E.isLoading,R=Object(o.useMutation)(S,{onSuccess:function(){O(void 0),I()}}),q=R.mutate,V=R.isLoading,W=Object(o.useMutation)(_,{onSuccess:function(){y(),I()}}).mutate,B=Object(c.useMemo)((function(){return(null===v||void 0===v?void 0:v.length)?v:[]}),[v]),D=Object(c.useCallback)((function(e){return i(e)}),[]),N=Object(c.useCallback)((function(){return i({name:""})}),[]),A=Object(c.useCallback)((function(){P(r)}),[r,P]),J=Object(c.useCallback)((function(){var e;O(null!==(e=null===T||void 0===T?void 0:T.credentials)&&void 0!==e?e:{})}),[T]),Y=Object(c.useCallback)((function(){q(j)}),[j,q]),H=Object(c.useMemo)((function(){return Object(ge.jsx)(Pe,{loading:g,items:B,onEdit:D,onAdd:N,onDelete:z})}),[B,g,D,N,z]);return Object(c.useEffect)((function(){var e=(null!==T&&void 0!==T?T:{}).credentials;if(e){var t=null!==e&&void 0!==e?e:{},n=t.username,a=t.password,c=t.broker;n&&a&&c||O(null!==e&&void 0!==e?e:{})}}),[T,j]),Object(ge.jsxs)("div",{children:[Object(ge.jsx)(We,{headerLeft:"\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430",headerRight:"\u0421\u0442\u0430\u0442\u0443\u0441",contentLeft:H,contentTop:Object(ge.jsx)(xt,{}),contentRight:Object(ge.jsx)(at,{value:null!==(e=null===T||void 0===T?void 0:T.credentials)&&void 0!==e?e:{},online:!!(null===T||void 0===T?void 0:T.online),onEdit:J,onReset:W,onRefresh:I,loading:M,error:null===T||void 0===T?void 0:T.error})}),!!r&&Object(ge.jsxs)(l.a,Object(d.a)(Object(d.a)({title:r.name?r.name:"\u041d\u043e\u0432\u043e\u0435 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e",width:1e3,onOk:A,onCancel:function(){return i(void 0)}},Object(d.a)(Object(d.a)({},Bt),{},{okButtonProps:Object(d.a)(Object(d.a)({},Bt.okButtonProps),{},{disabled:!h})})),{},{children:[Object(ge.jsx)(Nt,{children:Object(ge.jsx)(gt,{value:r,onChange:i,onValidStateChange:x,loading:Q})}),!h&&Object(ge.jsxs)(Jt,{children:["\u0414\u043b\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u044f \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 ",Object(ge.jsx)(At,{children:"*"})]})]})),j&&Object(ge.jsx)(l.a,Object(d.a)(Object(d.a)({title:"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435",width:700,onOk:Y,onCancel:function(){return O(void 0)}},Bt),{},{children:Object(ge.jsx)(Le,{value:j,onChange:O,error:null===T||void 0===T?void 0:T.error,loading:V})}))]})},Nt=b.a.div(Oe||(Oe=Object(s.a)(["\n  max-height: calc(100vh - 300px);\n  overflow: auto;\n"]))),At=b.a.div(fe||(fe=Object(s.a)(["\n  display: inline-block;\n  color: #ff4d4f;\n"]))),Jt=b.a.div(pe||(pe=Object(s.a)(["\n  position: absolute;\n  margin-top: 45px;\n  font-size: 15px;\n  color: #456;\n"]))),Yt=new o.QueryClient;i.a.render(Object(ge.jsx)(o.QueryClientProvider,{client:Yt,children:Object(ge.jsx)(Dt,{})}),document.getElementById("root"))}},[[268,1,2]]]);